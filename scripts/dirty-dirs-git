#!/usr/bin/env bash

set -euo pipefail

# Check for dirty git repositories in all subdirectories
for directory in */; do
    if [[ -d "$directory" ]]; then
        directory_name="${directory%/}"
        if git -C "$directory_name" rev-parse --is-inside-work-tree >/dev/null 2>&1; then
            if git -C "$directory_name" status --porcelain | grep -q .; then
                echo "$directory_name"
            fi
        fi
    fi
done
